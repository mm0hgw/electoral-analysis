p<-read.csv("csv/GE2010.csv")
p[1,]
p[p$Region=="Scotland",]
p<-p[p$Region=="Scotland",]
sum(p$V)/sum(p$N)
o<-read.csv("ref/2015-UK-General-election-data-collated-results-Constituency.csv")
o[1,]
o[grep("^S",o$Constituency.ID),]
o<-o[grep("^S",o$Constituency.ID),]
sum(p$V)/sum(p$N)
sum(o$V)/sum(o$N)
sum(o$Valid.Votes)/sum(o$Electorate)
sum(o$Valid.Votes)/sum(o$Electorate)-sum(p$V)/sum(p$N)
sum(o$Valid.Votes)/sum(o$Electorate)-sum(p$V)/sum(p$N) / (12*5)
sum(o$Valid.Votes)/sum(o$Electorate)-sum(p$V)/sum(p$N) / (12*5)
(sum(o$Valid.Votes)/sum(o$Electorate)-sum(p$V)/sum(p$N)) / (12*5)
i<-read.csv("csv/SIR2014.csv")
i
sum(i$V)/sum(i$N)
(sum(i$V)/sum(i$N)-sum(p$V)/sum(p$N)) / (12*4+4)
(sum(o$Valid.Votes)/sum(o$Electorate)-sum(i$V)/sum(i$N)) / (8)u<-
u<-read.csv("ref/2015-UK-General-election-data-collated-results-Constituency.csv")
sum(u$Valid.Votes)/sum(u$Electorate)
(78.8-72.8)/(10-2)
48 * 1.7
69/534
69/500
35/500
35/500
i
i$W
sum(i$W)
sum(i$W)*.223
69/500
29.3 - 69/500
.293 - 69/500
(.293 - 69/500)*sum(i$W)
(1-(.293 - 69/500))*sum(i$W)
(1-(.293 - 35/500))*sum(i$W)
(1-(69/500))*sum(i$W)
(1-(35/500))*sum(i$W)
(1-(69/500))*sum(i$W)
(1-(69/534))*sum(i$W)
(1-(35/500))*sum(i$W)
(1-(.293 - 69/500))*sum(i$W)
(1-(.293 - 35/500))*sum(i$W)
(1-(.293 - 19/500))*sum(i$W)
Y
Y<-1617989
N<-sum(i$W)
N<-funtion(x){(1-(.293 - 69/500))*sum(i$W)}
N<-function(x){(1-(.293 - x/500))*sum(i$W)}
T<-function(x){sum(i$V)-sum(i$W)+N(x)}
seq(1,69)
seq(1,69)
n
n<-seq(1,69)
N(n)/T(n)
Y/T(n)
N(n)/T(n)<0.5
Y/T(n)<0.5
N(n)/T(n)<Y/T(n)
N(n)<Y
N<-function(x){(1-(.293 - x/534))*sum(i$W)}
N(n)<Y
N(n)
Y
N<-function(x){(1-(.293 - x/500))*sum(i$W)}
N(n)
N(n)/T(n)
N(n)/T(n)*1000
help(floor)
round(N(n)/T(n),3)
T<-function(x){Y+N(x)}
round(Y/T(n),3)
signif((Y-N(n))/T(n),3)
signif((Y-N(n)),3)
signif((Y-N(n)))
round((Y-N(n)))
sum(i$W)-N(n)
round(sum(i$W)-N(n))
p
o
i
round(sum(i$W)-N(n))
l
l<-read.csv("ref/2015-UK-General-election-data-collated-results-Results.csv")
l
l[1,]
scot_cons <- grep("SNP",l$Description.on.ballot.paper)
scot_cons <- l[grep("SNP",l$Description.on.ballot.paper),]$Constituency.Name
scot_cons
l[ l$Constituency.Name %in% scot_cons,]
l<-l[ l$Constituency.Name %in% scot_cons,]
l
l[1,]
l$Description.on.ballot.paper
levels(l$Description.on.ballot.paper)
l$Description.on.ballot.paper
as.character(l$Description.on.ballot.paper)
levels(as.character(l$Description.on.ballot.paper))
as.factor(as.character(l$Description.on.ballot.paper))
scot_parties <- levels(as.factor(as.character(l$Description.on.ballot.paper)))
scot_parties
foreach(party=scot_parties)%do%{sum(l[ l$Description.on.ballot.paper=party,]$Votes)}
foreach(party=scot_parties)%do%{sum(l[ l$Description.on.ballot.paper==party,]$Votes)}
vapply(scot_parties,function(x){sum(l[ l$Description.on.ballot.paper==party,]$Votes)}
)
vapply(scot_parties,FUN=function(x){sum(l[ l$Description.on.ballot.paper==party,]$Votes)})
apply(scot_parties,FUN=function(x){sum(l[ l$Description.on.ballot.paper==party,]$Votes)})
apply(X=scot_parties,FUN=function(x){sum(l[ l$Description.on.ballot.paper==party,]$Votes)})
scot_parties
lapply(scot_parties,FUN=function(x){sum(l[ l$Description.on.ballot.paper==party,]$Votes)})
lapply(scot_parties,FUN=function(x){sum(l[ l$Description.on.ballot.paper==x,]$Votes)})
unlist(lapply(scot_parties,FUN=function(x){sum(l[ l$Description.on.ballot.paper==x,]$Votes)}))
scot_turnouts <- unlist(lapply(scot_parties,FUN=function(x){sum(l[ l$Description.on.ballot.paper==x,]$Votes)}))
names(scot_turnouts)<-scot_parties
scot_turnouts
scot_turnouts[order(scot_turnouts)]
scot_turnouts/sum(scot_turnouts)
scot_turnouts_pc <- scot_turnouts/sum(scot_turnouts)
scot_turnouts_pc
round(scot_turnouts_pc,3)
round(sum(i$W)-N(n))
(Y<N(n))
(Y>N(n))
sum(Y>N(n))
scot_parties
l[ l$Description.on.ballot.paper==scot_parties[2],]
scot_parties
scot_turnouts[c(9,12,13)]
sum(scot_turnouts[c(9,12,13)])
sum(scot_turnouts[-c(9,12,13)])
proY<-sum(scot_turnouts[c(9,12,13)])
proN<-sum(scot_turnouts[-c(9,12,13)])
(Y-proY)/Y
(N(500)-proN)/N(500)
(sum(i$W)-proN)/sum(i$W)
(Y-proY)/proY
(sum(i$W)-proN)/
(sum(i$W)-proN)/sum(i$W)
(Y-proY)/Y
(Y-proY)
(sum(i$W)-proN)
N<-function(x){floor((1-(((sum(i$W)-proN)/sum(i$W)) - x/500))*sum(i$W))}
round(sum(i$W)-N(n))
n<-seq(0,69)
round(sum(i$W)-N(n))
(Y>N(n))
(sum(i$W)-proN)/sum(i$W)
lostN_pc<-(sum(i$W)-proN)/sum(i$W)
(Y-proY)/Y
lostY_pc<-(Y-proY)/Y
500*lostN_pc
465*lostY_pc
sum(round(sum(i$W)-N(n))<307625)
sum(round(sum(i$W)-N(n)))
round(sum(i$W)-N(n))
round(sum(i$W)-N(n))<307625
(round(sum(i$W)-N(n)))<307625
(round(sum(i$W)-N(n)))<307625
(round(sum(i$W)-N(n)))<3076255
(round(sum(i$W)-N(n)))<307625
(round(sum(i$W)-N(n)))
(round(sum(i$W)-N(n)))<407625
(round(sum(i$W)-N(n)))>407625
sum((round(sum(i$W)-N(n)))>407625)
sum(Y>N(n))
