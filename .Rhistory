(sum(i$W)-proN)/sum(i$W)
lostN_pc<-(sum(i$W)-proN)/sum(i$W)
(Y-proY)/Y
lostY_pc<-(Y-proY)/Y
500*lostN_pc
465*lostY_pc
sum(round(sum(i$W)-N(n))<307625)
sum(round(sum(i$W)-N(n)))
round(sum(i$W)-N(n))
round(sum(i$W)-N(n))<307625
(round(sum(i$W)-N(n)))<307625
(round(sum(i$W)-N(n)))<307625
(round(sum(i$W)-N(n)))<3076255
(round(sum(i$W)-N(n)))<307625
(round(sum(i$W)-N(n)))
(round(sum(i$W)-N(n)))<407625
(round(sum(i$W)-N(n)))>407625
sum((round(sum(i$W)-N(n)))>407625)
sum(Y>N(n))
library(rgl)
data(volcano)
z <- 2 * volcano # Exaggerate the relief
x <- 10 * (1:nrow(z)) # 10 meter spacing (S to N)
y <- 10 * (1:ncol(z)) # 10 meter spacing (E to W)
zlim <- range(z)
zlen <- zlim[2] - zlim[1] + 1
colorlut <- terrain.colors(zlen,alpha=0) # height color lookup table
col <- colorlut[ z-zlim[1]+1 ] # assign colors to heights for each point
open3d()
rgl.surface(x, y, z, color=col, alpha=0.75, back="lines")
dim(volcano)
prod(dim(volcano))
z1<-rbind(volcano,volcano,volcano)
z2<-cbind(z1,z1,z1)
z<-2*z2
x <- 10 * (1:nrow(z)) # 10 meter spacing (S to N)
y <- 10 * (1:ncol(z)) # 10 meter spacing (E to W)
zlim <- range(z)
zlen <- zlim[2] - zlim[1] + 1
col <- colorlut[ z-zlim[1]+1 ] # assign colors to heights for each point
open3d()
rgl.surface(x, y, z, color=col, alpha=0.75, back="lines")
colorlut <- heat.colors(zlen,alpha=1) # use different colors for the contour map
col <- colorlut[ z-zlim[1]+1 ] 
rgl.surface(x, y, matrix(1, nrow(z), ncol(z)),color=col, back="fill")
source("figures.r")
source("figures.r")
source("figures.r")
source("figures.r")
normalised_sample(seq(1,9))
density(normalised_sample(seq(1,9)))
plot(density(normalised_sample(seq(1,9))))
p
o
i
source("figures.r")
normalised(i$V/i$N)
plot(density(normalised(i$V/i$N)))
source("figures.r")
table_one_line(i)
source("figures.r")
table_one_line(i)
table_one_line(o)
table_one_line(p)
o$V <- o$Valid.Votes
o$N <- o$Electorate
table_one_line(o)
rbind(table_one_line(i),table_one_line(o),table_one_line(p))
ls("csv/")
file("csv/")
list.files("csv/")
source("figures.r")
rbind(table_one_line(i),table_one_line(o),table_one_line(p))
rbind(table_one_line(i),table_one_line(o),table_one_line(p))
rbind(table_one_line(i),table_one_line(o),table_one_line(p))
rbind(table_one_line(i),table_one_line(o),table_one_line(p))
read.csv("csv/Quebec 1980.csv")
q80<-read.csv("csv/Quebec 1980.csv")
q80
q80[1,]
q80[,"V"]
as.numeric(q80[,"V"])
as.character(q80[,"V"])
q80<-read.csv("csv/Quebec 1980.csv",strip.white=T)
q80<-read.csv("csv/Quebec 1980.csv",strip.white=TRUE)
q80[,"V"]
q80<-read.csv("csv/Quebec 1980.csv",strip.white=TRUE)
source("import.r")
source("import.r")
p
assemble_sample()
registerDoSEQ()
assemble_sample()
source("cluster.r")
assemble_sample()
read_ballot("csv/Quebec 1995.csv")
read.table("keys.tab")
source("import.r")
read_ballot("csv/Quebec 1995.csv")
source("import.r")
read_ballot("csv/Quebec 1995.csv")
read_ballot("csv/SIR2014.csv")
q80
q80[,"V"]
as.character(q80[,"V"])
gsub(" ","",as.character(q80[,"V"]))
help (gsub)
gsub(" ","",as.character(q80[,"V"]),fixed=TRUE)
gsub(" |","",as.character(q80[,"V"]),fixed=TRUE)
gsub(" ","",as.character(q80[,"V"]),fixed=TRUE)
gsub("\\s","",as.character(q80[,"V"]))
library(regex)
gsub("[[:space:]]","",as.character(q80[,"V"]))
gsub("[^0-9]","",as.character(q80[,"V"]))
as.numeric(gsub("[^0-9]","",as.character(q80[,"V"])))
V
q80_V<-as.numeric(gsub("[^0-9]","",as.character(q80[,"V"])))
q80_N<-as.numeric(gsub("[^0-9]","",as.character(q80[,"N"])))
plot(density(normalised(q80_V/q80_N)))
q80_csv <- q80
q80 <- list()
q80$V<-q80_V
q80$N<-q80_N
q80
table_one_line(q80)
q92_csv<-read.csv("csv/Quebec 1992.csv",strip.white=TRUE)
q92
q92$V<-as.numeric(gsub("[^0-9]","",as.character(q92[,"V"])))
q92$V<-as.numeric(gsub("[^0-9]","",as.character(q92_csv$V)))
q92$N<-as.numeric(gsub("[^0-9]","",as.character(q92_csv$N)))
q95_csv<-read.csv("csv/Quebec 1995.csv",strip.white=TRUE)
q95 <- list()
q95$N<-as.numeric(gsub("[^0-9]","",as.character(q95_csv$N)))
q95$V<-as.numeric(gsub("[^0-9]","",as.character(q95_csv$V)))
rbind(table_one_line(i),table_one_line(o),table_one_line(p),table_one_line(q80),table_one_line(q92),table_one_line(q95))
plot(density(normalised(q95$V/q95$N)))
q95_density<-density(normalised(q95$V/q95$N))
lines(x=q95_density$x,y=dnorm(x=q95_density$x))
i
s14_density<-density(normalised(i$V/i$N))
plot(s14_density)
lines(x=s14_density$x,y=dnorm(x=s14_density$x))
lines(x=s14_density$x,y=dnorm(x=s14_density$x),col="magenta")
lines(x=q95_density$x,y=q95_density$y,col="blue")
rbind(table_one_line(i),table_one_line(o),table_one_line(p),table_one_line(q80),table_one_line(q92),table_one_line(q95))
source("figures.r")
rbind(table_one_line(i),table_one_line(o),table_one_line(p),table_one_line(q80),table_one_line(q92),table_one_line(q95))
source("figures.r")
rbind(table_one_line(i),table_one_line(o),table_one_line(p),table_one_line(q80),table_one_line(q92),table_one_line(q95))
source("figures.r")
density_range(list(q95_density))
dd<-density_range(list(q95_density))
dd
colnames(dd)<-c("min","max")
dd
source("figures.r")
density_range(list(q95_density))
density_range(list(q95_density,density(i$V/i$N)))
s14_density
density_range(list(q95_density,s14_density))
density_range(list(q95_density,s14_density))
density_range(list(q95_density))
density_range(list(q95_density,s14_density))
dd<-density_range(list(q95_density,s14_density))
plot(q95_density,xlim=dd$x_range,ylim=dd$y_range)
plot(q95_density,xlim=dd["x_range",],ylim=dd["y_range",])
lines(s14_density)
plot(s14_density,xlim=dd["x_range",],ylim=dd["y_range",])
lines(q95_density)
plot(xlim=dd["x_range",],ylim=dd["y_range",])
plot(x=NULL,xlim=dd["x_range",],ylim=dd["y_range",])
lines(q95_density)
lines(s14_density)
lines(s14_density,col=1)
lines(s14_density,col=2)
lines(s14_density,col=3)
lines(s14_density,col=4)
lines(s14_density,col=5)
legend()
legend(legend="bob")
legend(legend="bob",x="not bob")
legend(legend="left",x="not bob")
legend(legend="left",x="right")
legend(legend="green",x="right")
legend(legend=seq(1,6),x="right")
limits
seq(2,length.out=2)
source("figures.r")
source("figures.r")
plot_d_list(list(q95_density,s14_density))
source("figures.r")
plot_d_list(list(q95_density,s14_density))
source("figures.r")
plot_d_list(list(q95_density,s14_density))
source("figures.r")
plot_d_list(list(q95_density,s14_density))
plot_d_list(list(q95=q95_density,s14=s14_density))
plot_d_list(list(q95=q95_density,s14=s14_density))
source("figures.r")
source("figures.r")
plot_d_list(list(q95_density,s14_density))
source("figures.r")
plot_d_list(list(q95_density,s14_density))
plot_d_list(list(q95=q95_density,s14=s14_density))
source("figures.r")
plot_d_list(list(q95=q95_density,s14=s14_density))
source("figures.r")
plot_d_list(list(q95=q95_density,s14=s14_density))
source("figures.r")
plot_d_list(list(q95=q95_density,s14=s14_density))
source("figures.r")
plot_d_list(list(q95=q95_density,s14=s14_density))
source("figures.r")
plot_d_list(list(q95=q95_density,s14=s14_density))
source("figures.r")
plot_d_list(list(q95=q95_density,s14=s14_density))
source("figures.r")
source("figures.r")
plot_d_list(list(q95=q95_density,s14=s14_density))
source("figures.r")
plot_d_list(list(q95=q95_density,s14=s14_density))
help(plot)
source("figures.r")
plot_d_list(list(q95=q95_density,s14=s14_density))
plot_d_list(list(q95=q95_density,s14=s14_density))
q95_d <- q95_density
s14_d <- s14_density
p
table_one_line
o
s10_d<-density(p$V/p$N)
s15_d<-density(o$V/o$N)
q92_
q92_d<-density(q92$V/q92$N)
q80_d<-density(q80$V/q80$N)
plot_d_list(list(Quebec80=q80_d,Quebec92=q92_d,Quebec95=q95_d,Scotland10=s10_d,Scotland14=s14_d,Scotland15=s15_d))
s10_d<-density(normalised(p$V/p$N))
plot_d_list(list(Quebec80=q80_d,Quebec92=q92_d,Quebec95=q95_d,Scotland10=s10_d,Scotland14=s14_d,Scotland15=s15_d))
q92_d<-density(normalised(q92$V/q92$N))
plot_d_list(list(Quebec80=q80_d,Quebec92=q92_d,Quebec95=q95_d,Scotland10=s10_d,Scotland14=s14_d,Scotland15=s15_d))
q80_d<-density(normalised(q80$V/q80$N))
plot_d_list(list(Quebec80=q80_d,Quebec92=q92_d,Quebec95=q95_d,Scotland10=s10_d,Scotland14=s14_d,Scotland15=s15_d))
plot_d_list(list(Quebec80=q80_d,Quebec92=q92_d,Quebec95=q95_d,Scotland10=s10_d,Scotland14=s14_d,Scotland15=s15_d))
s15_d<-density(normalised(o$V/o$N))
plot_d_list(list(Quebec80=q80_d,Quebec92=q92_d,Quebec95=q95_d,Scotland10=s10_d,Scotland14=s14_d,Scotland15=s15_d))
d_list <- (list(Quebec80=q80_d,Quebec92=q92_d,Quebec95=q95_d,Scotland10=s10_d,Scotland14=s14_d,Scotland15=s15_d))
d_list
q80_d<-density(normalised(q80$V/q80$N))
d_list <- (list(Quebec80=q80_d,Quebec92=q92_d,Quebec95=q95_d,Scotland10=s10_d,Scotland14=s14_d,Scotland15=s15_d))
d_list
plot_d_list(d_list)
table_one_line(q80)
lapply(FUN=table_one_line,list(q80,q92,q95))
foreach(l=list(q80,q92,q95).combine=rbind)%do%{table_one_line(l)}
foreach(l=list(q80,q92,q95),.combine=rbind)%do%{table_one_line(l)}
o
o[1,]
b_list <- list(Quebec80=q80,Quebec92=q92,Quebec95=q95,Scotland10=p,Scotland14=i,Scotland15=o)
b_list
source("figures.r")
b_list
figure_one_b_list(b_list)
figure_one_b_list(b_list)
table_one_list(b_list)
source("figures.r")
table_one_list(b_list)
source("figures.r")
table_one_list(b_list)
b_list
foreach(b=b_list)
foreach(b=b_list)%do%{table_one_line(b)}
foreach(b=b_list,.combine=rbind)%do%{table_one_line(b)}
table_one_list(b_list)
table_one_b_list(b_list)
source("figures.r")
table_one_b_list(b_list)
source("figures.r")
table_one_b_list(b_list)
t1<-table_one_b_list(b_list)
t1[order(t1[,4]),]
t1[order(t1[,"Deviance"]),]
source("figures.r")
t1<-table_one_b_list(b_list)
t1[order(t1[,"AbsDeviance"]),]
plot(density(t1[,"AbsDeviance"]))
source("figures.r")
figure_one(b_list)
figure_two(b_list)
source("figures.r")
figure_one(b_list)
source("figures.r")
figure_one(b_list)
figure_two(b_list)
source("figures.r")
figure_one(b_list)
figure_one(b_list)
source("figures.r")
figure_one(b_list)
figure_two(b_list)
source("figures.r")
pdf()
figure_one(b_list)
figure_two(b_list)
dev.off()
table_one(b_list)
plot(density(t1[,"AbsDeviance"]))
pdf()
figure_one(b_list)
figure_two(b_list)
plot(density(t1[,"AbsDeviance"]))
dev.off()
plot(density(t1[,"AbsDeviance"]),main="Density curve of absolute deviations between population and sample means of entire data set.")
pdf()
figure_one(b_list)
figure_two(b_list)
plot(density(t1[,"AbsDeviance"]),main="Density curve of absolute deviations between population and sample means of entire data set.")
dev.off()
plot(density(t1[,"AbsDeviance"]),main="Absolute deviations between population and sample mean")
pdf()
figure_one(b_list)
figure_two(b_list)
plot(density(t1[,"AbsDeviance"]),main="Absolute deviations between population and sample mean")
dev.off()
source("figures.r")
figure_one_b(b_list)
source("figures.r")
figure_one_b(b_list)
source("figures.r")
figure_one_b(b_list)
pdf()
figure_one(b_list)
figure_two(b_list)
figure_one_b(b_list)
plot(density(t1[,"AbsDeviance"]),main="Absolute deviations between population and sample mean")
dev.off()
source("figures.r")
pdf()
figure_one(b_list)
figure_two(b_list)
figure_one_b(b_list)
plot(density(t1[,"AbsDeviance"]),main="Absolute deviations between population and sample mean")
dev.off()
t1
png()
figure_one_b(b_list)
dev.off()
png()
plot(density(t1[,"AbsDeviance"]),main="Absolute deviations between population and sample mean")
dev.off()
ls("max")
source("figures.r")
unstuffed_b_list <- ballot_unstuffer_list(b_list)
source("figures.r")
unstuffed_b_list <- ballot_unstuffer_list(b_list)
help (mclapply)
registerDoParallel()
source("cluster.r")
cl
cl<-makeCustomCluster()
cl
registerDoParallel()
source("figures.r")
unstuffed_b_list <- ballot_unstuffer_list(b_list)
ballot_s_remover(i)
ballot_s_remover(i)$V
i$V-ballot_s_remover(i)$V
source("figures.r")
i$V-ballot_s_remover(i)$V
source("figures.r")
i$V-ballot_s_remover(i)$V
source("figures.r")
i$V-ballot_s_remover(i)$V
ballot_s_remover(i)$V
ballot_s_remover(i)
i
ballot_s_remover(i)
ballot_unstuffer_s(i)
u_b_list<-ballot_unstuffer_list(b_list)
figure_one(u_b_list)
table_one(b_list)
table_one(u_b_list)
table_one(b_list)-table_one(u_b_list)
(table_one(b_list)-table_one(u_b_list))$Votes/table_one(b_list)$Electorate
(table_one(b_list)-table_one(u_b_list))[,"Votes"]/table_one(b_list)$Electorate
(table_one(b_list)-table_one(u_b_list))[,"Votes"]/table_one(b_list)[,"Electorate"]
(table_one(b_list)-table_one(u_b_list))[,"Votes"]/table_one(b_list)[,"Electorate"]*100
figure_one(list(u_b_list[[1]]))
figure_one(list(Quebec80=u_b_list[[1]]))
figure_one_b(list(Quebec80=u_b_list[[1]]))
figure_one(list(Quebec80=u_b_list[[1]]))
figure_one(list(Quebec92=u_b_list[[2]]))
figure_one(list(Quebec95=u_b_list[[3]]))
figure_one(list(Scotland10=u_b_list[[4]]))
figure_one(list(Scotland15=u_b_list[[6]]))
figure_one_b(list(Scotland15unstuffed=u_b_list[[6]],Scotland15=b_list[[6]]))
figure_one_b(list(Scotland10unstuffed=u_b_list[[4]],Scotland10=b_list[[4]]))
b_list-u_b_list
table_one(u_b_list)
table_one(b_list)-table_one(u_b_list)
plot(density(table_one(b_list)-table_one(u_b_list)[,"SampleMean"]))
plot(density((table_one(b_list)-table_one(u_b_list))[,"SampleMean"]))
plot(density((table_one(b_list)-table_one(u_b_list))[,"PopMean"]))
table_one(b_list)
source("figures.r")
lapply(b_list,FUN=chisq_test)
source("figures.r")
lapply(b_list,FUN=chisq_unstuffer)
lapply(b_list,FUN=chisq_unstuffer)
source("figures.r")
lapply(b_list,FUN=chisq_unstuffer)
source("figures.r")
z<-lapply(b_list,FUN=chisq_unstuffer)
z<-lapply(b_list,FUN=chisq_unstuffer)
source("figures.r")
z<-lapply(b_list,FUN=chisq_unstuffer)
source("figures.r")
z<-lapply(b_list,FUN=chisq_unstuffer)
source("figures.r")
z<-lapply(b_list,FUN=chisq_unstuffer)
source("figures.r")
z<-lapply(b_list,FUN=chisq_unstuffer)
source("figures.r")
z<-lapply(b_list,FUN=chisq_unstuffer)
b
b
a
chisq_unstuffer(b)
source("figures.r")
chisq_unstuffer(b)
z<-chisq_unstuffer(b)
chisq_unstuffer(b)
source("figures.r")
z<-chisq_unstuffer(b)
source("figures.r")
z<-chisq_unstuffer(b)
source("figures.r")
z<-chisq_unstuffer(b)
b
z<-chisq_unstuffer(u_b_list[[4]])
z
z<-chisq_unstuffer(u_b_list[[5]])
source("figures.r")
z<-chisq_unstuffer(u_b_list[[5]])
source("figures.r")
z<-chisq_unstuffer(u_b_list[[5]])
z<-chisq_unstuffer(u_b_list[[5]])
source("figures.r")
z<-chisq_unstuffer(u_b_list[[5]])
z
figure_one(list(z))
figure_one(list(z=z))
plot(density(z$V/z$N))
source("figures.r")
c_b_list<-chisq_unstuffer_list(b_list)
mcoptions
help(foreach)
source("figures.r")
c_b_list<-chisq_unstuffer_list(b_list)
cl
rm(cl)
cl<-makeCustomCluster()
source("cluster.r")
cl<-makeCustomCluster()
c_b_list<-chisq_unstuffer_list(b_list)
source("cluster.r")
c_b_list<-chisq_unstuffer_list(b_list)
source("cluster.r")
c_b_list<-chisq_unstuffer_list(b_list)
stopCluster(cl)
cl<-makeCustomCluster()
c_b_list<-chisq_unstuffer_list(b_list)
stopCluster(cl)
source("cluster.r")
cl<-makeCustomCluster()
cl
c_b_list<-chisq_unstuffer_list(b_list)
cl
stopCluster(cl)
source("cluster.r")
source("figures.r")
c_b_list<-chisq_unstuffer_list(b_list)
source("figures.r")
cl
registerDoParallel()
c_b_list<-chisq_unstuffer_list(b_list)
source("figures.r")
cl
c_b_list<-chisq_unstuffer_list(b_list)
z<-chisq_unstuffer(u_b_list[[5]])
source("figures.r")
z<-chisq_unstuffer(u_b_list[[5]])
z<-chisq_unstuffer(u_b_list[[5]])
source("figures.r")
z<-chisq_unstuffer(u_b_list[[5]])
source("figures.r")
z<-chisq_unstuffer(u_b_list[[5]])
b
source("figures.r")
z<-chisq_unstuffer(u_b_list[[5]])
source("figures.r")
z<-chisq_unstuffer(u_b_list[[5]])
source("figures.r")
z<-chisq_unstuffer(u_b_list[[5]])
source("figures.r")
z<-chisq_unstuffer(u_b_list[[5]])
source("figures.r")
z<-chisq_unstuffer(u_b_list[[5]])
source("figures.r")
z<-chisq_unstuffer(u_b_list[[5]])
z<-chisq_unstuffer(b_list[[5]])
source("figures.r")
z<-chisq_unstuffer(b_list[[5]])
